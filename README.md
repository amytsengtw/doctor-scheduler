# 🏥 婦產科雙軌排班系統 (Big/Small Shift Roster)

這是一個專為醫療單位設計的雙軌排班系統，支援 **JSON 設定檔存取**，並將班表分為「大班 (產房)」與「小班 (一般)」兩條獨立邏輯進行運算。

## ✨ 核心功能 (Features)

### 1. 📂 JSON 設定檔存取
*   **一鍵儲存**：所有的醫師名單、預假、指定值班日期，都可以下載成 `.json` 檔案。
*   **快速還原**：下次排班時，直接上傳 `.json` 檔，即可還原所有設定，無需重新輸入。

### 2. 🔴 大班 (Big Shift) - 產房班
*   **人員構成**：主治醫師 (VS) + 住院醫師 (R)。
*   **排班邏輯**：
    1.  **VS 優先**：主治醫師指定的班別 (Wish) 視為**最高指令**，系統優先保留。
    2.  **R 填空**：剩餘空缺由住院醫師填補。
    3.  **R 保護**：住院醫師的「絕對不值班日 (No-Go)」為**硬限制**，系統絕不安排。
    4.  **VS 救援**：只有在 R 的人力完全耗盡或被 No-Go 卡死時，系統才會安排 VS 支援非指定班 (會有極高扣分，非必要不發生)。

### 3. 🔵 小班 (Small Shift) - 一般班
*   **人員構成**：PGY 醫師 + 實習醫師 (Intern)。
*   **排班邏輯**：
    *   **Intern 嚴格限制 (Hard Constraints)**：
        *   單週 (Mon-Sun) 最多 2 班。
        *   每月平日 (Weekday) 最多 6 班。
        *   每月假日 (Weekend) 最多 2 班。
    *   **PGY 彈性限制 (Soft Constraints)**：
        *   基礎限制同上 (平日6/假日2)。
        *   **自動救援**：若人力不足，系統允許 PGY 稍微超標 (但會盡量最小化超標數量)。
    *   **意願處理**：
        *   **不想值班 (No-Go)**：盡量滿足 (Soft)，但若無人可排仍可能安排。
        *   **想要值班 (Wish)**：不一定滿足，視人力分配而定。

## 🚀 如何使用

1.  **設定時間**：在側邊欄選擇年份與月份。
2.  **輸入名單**：在「人員設定」分頁輸入四類醫師名單。
3.  **填寫意願**：
    *   展開「大班意願」：填寫 VS 指定班、R 的預假。
    *   展開「小班意願」：填寫 PGY/Intern 的想值與不想值。
4.  **存檔 (Optional)**：點擊側邊欄的「💾 下載設定檔」備份目前輸入。
5.  **排班**：點擊最下方的「🚀 開始雙軌排班」。

## 🛠 技術架構

*   **前端**：[Streamlit](https://streamlit.io/)
*   **演算法**：[Google OR-Tools](https://developers.google.com/optimization) (CP-SAT)
*   **資料交換**：JSON Format

## ⚠️ 免責聲明
系統排班結果僅供參考，若出現 PGY 超時工作或 VS 支援狀況，代表當前人力配置在數學上無法滿足所有完美條件，請總醫師人工介入協調。
